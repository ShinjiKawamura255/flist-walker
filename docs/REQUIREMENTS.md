# REQUIREMENTS

## Background / KPI
- CLI 上で `fzf --walker` 相当の体験で、ファイル/フォルダを高速に横断検索したい。
- 既存資産として `FileList.txt`（`filelist.txt` を含む）を利用し、事前に管理した対象集合を検索したい。
- KPI-001: 10万件規模の候補に対して初回インデックス後の検索応答を 100ms 未満（ローカル開発機）にする。
- KPI-002: Python 試作で UX と I/O 契約を固め、Rust 実装へ仕様移植できる状態にする。

## Scope
### In
- ファイル/フォルダの収集（walker / FileList 両対応）。
- クエリ文字列によるファジー検索。
- 検索結果からファイル実行または既定アプリでオープン。
- 検索結果からフォルダをオープン。
- Python での試作実装とドキュメント化（SDD/TDD）。

### Out
- Rust 本実装そのもの。
- ネットワーク共有ドライブ最適化。
- GUI ネイティブアプリ化（今回は CLI ベース）。

## Use cases
- UC-001: 開発者がプロジェクト配下を横断検索し、目的ファイルを即時オープンする。
- UC-002: 利用者が `FileList.txt` に列挙した対象のみ検索し、実行可能ファイルを起動する。
- UC-003: 利用者が検索結果のフォルダを選択し、OS のファイルマネージャで開く。

## Requirements
### Functional (FR)
- FR-001: ツールは `FileList.txt` または `filelist.txt` が存在する場合、当該リストを優先して候補集合を構築しなければならない。
- FR-002: ツールはリスト未存在時、walker 方式で再帰走査してファイル/フォルダ候補を構築しなければならない。
- FR-003: ツールは候補集合に対してファジー検索を提供し、関連度順で結果を返さなければならない。
- FR-004: ツールは選択対象がファイルの場合、実行可能なら実行し、非実行ファイルは既定アプリでオープンしなければならない。
- FR-005: ツールは選択対象がフォルダの場合、OS 既定の方法でオープンしなければならない。
- FR-006: ツールは Python 試作で確定した CLI 入出力仕様を Rust 実装へ移植可能な形で文書化しなければならない。

### Non-functional (NFR)
- NFR-001: 10万件候補での検索処理は 100ms 未満を目標（SHOULD）とする。
- NFR-002: 例外時はユーザ向けに原因を表示し、非ゼロ終了コードを返すこと。
- NFR-003: モジュールはテスト可能に分離され、主要機能に unit test を持つこと。

### Constraints (CON)
- CON-001: 第1フェーズは Python で実装し、外部ライブラリ利用を許可する。
- CON-002: 第2フェーズは Rust で本実装する前提で、仕様の差分を最小化する。

## Acceptance Criteria
- AC-001: `FileList.txt` 存在時に walker を使わず、列挙対象のみが検索結果候補になる。
- AC-002: `FileList.txt` と `filelist.txt` の双方で同等に動作する。
- AC-003: クエリ入力で関連度順上位 N 件を返せる。
- AC-004: ファイル選択時に実行/オープン、フォルダ選択時にオープンが行われる。
- AC-005: Python 試作のテストがすべて成功する。

## Risks
- R-001: OS ごとのオープン/実行差異により挙動不一致が発生する。軽減策: 実行/オープン分岐を抽象化しテストで検証する。
- R-002: 大規模ディレクトリでの走査コストが増大する。軽減策: FileList 優先とキャッシュ戦略を Rust 本実装で導入予定。

## Traceability (excerpt)
- FR-001 -> SP-001 -> DES-001 -> TC-001
- FR-002 -> SP-002 -> DES-002 -> TC-002
- FR-003 -> SP-003 -> DES-003 -> TC-003
- FR-004 -> SP-004 -> DES-004 -> TC-004
- FR-005 -> SP-005 -> DES-004 -> TC-005
- FR-006 -> SP-006 -> DES-005 -> TC-006
- NFR-001 -> SP-007 -> DES-006 -> TC-007
- NFR-002 -> SP-008 -> DES-007 -> TC-008
- NFR-003 -> SP-009 -> DES-008 -> TC-009
